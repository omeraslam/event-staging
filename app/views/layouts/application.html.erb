<!DOCTYPE html>
<html>
<head>
  <title><%= title %></title>
  <meta name="keywords" content="<%= meta_keywords %>" /> 
  <meta name="description" content="<%= meta_description %>" />

  <meta name="google-site-verification" content="N3as54yWdnHGj6rqX9tI8Ba8niZb8dRYxQqfrqhmFis" />
  <meta name="viewport" content="width=device-width">

  <!-- load typekit font -->
  <script src="//use.typekit.net/lkw3rge.js"></script>
  <script>try{Typekit.load();}catch(e){}</script>
  <!-- end load typekit font -->
  
  <!-- load typography.com -->
  <link rel="stylesheet" type="text/css" href="//cloud.typography.com/6635554/696128/css/fonts.css" />
  <!-- end load typography.com -->
  

  <!-- load fontawesome -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <!-- end fontawesome -->

  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>
</head>

<!--<body <%= current_root_class %> >-->
<body class="<%= controller.controller_name %>">
  <%= render 'layouts/partials/nav' %>

  <%= render 'layouts/partials/alert' %>
  
<%= yield %>


<footer>
  &copy; 2015 EventCreate. All rights reserved.
</footer>





















<script>


  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-64644710-1', 'auto');
  ga('send', 'pageview');




$(function() {
  var source = [];
$.ajax({
  url: '/dashboard',
  dataType: 'json',
  type: 'GET'
}).done(function(response) {

  for (var i = response.length - 1; i >= 0; i--) {
    var obj = {
      target: '/dashboard/event?event='+ response[i].id,
      value: response[i].name
    }
    source.push(obj);
  };



   $( "#tags" ).autocomplete({
     source: source,
     minLength: 0,
     select: function( event, ui ) { 
          window.location.href = ui.item.target;
     }
   }).focus(function(){            
        $(this).autocomplete("search");
    });
 });

});




   </script>
   
   <script>
   if(document.getElementsByClassName('event-page').length > 0 ) {


    var initMap;

    initMap = function() {

      var address, codeAddress, geocoder, getLocation, infowindow, latlng, map, marker, showPosition;
      geocoder = void 0;
      geocoder = new google.maps.Geocoder;
      latlng = void 0;
      var iconBase = 'https://maps.google.com/mapfiles/kml/shapes/';
    
      map = new google.maps.Map(document.getElementById('map'), {
        center: latlng,
        zoom: 13,
        disableDefaultUI: true,
        zoomControl: false,
        scrollwheel: false,
        backgroundColor: 'none'

      });

      getLocation = function() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
        } else {
          x.innerHTML = 'Geolocation is not supported by this browser.';
        }
      };
      showPosition = function(position) {
        var lat, long;
        lat = position.coords.latitude;
        long = position.coords.longitude;
        latlng = new google.maps.LatLng(lat, long);
      };
      codeAddress = function() {
        var address;

        var styles = [
          {
            stylers: [
              { hue: "#00ffe6" },
              { saturation: -20 }
            ]
          },{
            featureType: "road",
            elementType: "geometry",
            stylers: [
              { lightness: 100 },
              { visibility: "simplified" }
            ]
          },{
            featureType: "road",
            elementType: "labels",
            stylers: [
              { visibility: "off" }
            ]
          }
        ];

        address = $('.visible.event-page .location').text() === '' ? 'Los Angeles, CA' : $('.visible.event-page .location').text();
        geocoder.geocode({
          'address': address
        }, function(results, status) {
          if (status === google.maps.GeocoderStatus.OK) {
            map.setOptions({styles: styles});
            map.setCenter(results[0].geometry.location);
            marker = new google.maps.Marker({
              map: map,
              position: results[0].geometry.location,
              //icon: iconBase + 'schools_maps.png'
            });


          } else {
        //alert('Geocode was not successful for the following reason: ' + status);
        alert('Location not found');
      }
    });
      };
  // 

  codeAddress();




  setMapOnAll = function(map) {

    marker.setMap(null);

    codeAddress();
  }

if($('.signed-in').length > 0 && $('#event-edit').length > 0) {

    $('span[data-bip-attribute="location').bind('focusin', function() {

      $('.visible span[data-bip-attribute="location"] input').val($('.visible span[data-bip-attribute="location"]').attr('data-bip-value'));

      var input = /** @type {!HTMLInputElement} */(
        document.querySelector('.visible span[data-bip-attribute="location"] input'));
      var autocomplete = new google.maps.places.Autocomplete(input);
    });
  // on success of address input, recalculate map position
  $('span[data-bip-attribute="location"] ').bind('ajax:success', function(){

    $('span[data-bip-attribute="location"]').text($('.visible span[data-bip-attribute="location"]').text())

    $('span[data-bip-attribute="location"]').attr('data-bip-original-content', $('.visible span[data-bip-attribute="location"]').text())
    $('span[data-bip-attribute="location"]').attr('data-bip-value', $('.visible span[data-bip-attribute="location"]').text())

    setMapOnAll(null);

  });

}

};


}



</script>







<script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places&callback=initMap"
async defer></script>

</body>
</html>
